<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:p="http://primefaces.org/ui"
    xmlns:c="http://java.sun.com/jsp/jstl/core">

    <ui:composition template="../../template/templatepagsistemas.xhtml">

        <ui:define name="body">
               <!-- INICIO DO FORMULARIO -->
    <div class="col-md-8">
        <h:form> <p:commandButton value="Voltar"
			style="position:relative; right:18%; width:100px; " icon="btvoltar"
			action ="/pages/sishosp/gerenciarLaudo.faces"></p:commandButton>  </h:form>
        
 <h:form id="formLaudo" >
 <p:growl id="message"/>
			<p:panel header="#{LaudoController.cabecalho}" style="position: relative; height:auto; width:auto; background-color: #F5F5F5; left:30%;">
			<h:panelGrid columns="3">
			

					<h:outputLabel for="prog" value="Programa:" />
					<p:outputPanel id="outProg">
						<p:inputText id="codProg"
							value="#{LaudoController.laudo.programa.idPrograma}" readonly="true"
							style="width: 40px; margin-left:20px;" />
						<p:inputText id="prog"
							value="#{LaudoController.laudo.programa.descPrograma}" readonly="true"
							style="width: 300px" />
					</p:outputPanel>
					<p:commandButton id="btBusPr" value="Buscar"
						onclick="PF('dlgConsuProg').show();" />

					
				</h:panelGrid>

			
				
				<h:panelGrid columns="2" styleClass="semBorda">
				
				     <p:outputPanel style="margin-left:1px; margin-top:20px;">
						<h:outputLabel  value="Prontuário:" />
						<br />
					   	<p:inputText 
							value="#{LaudoController.laudo.apac}" readonly="false"/>
					    </p:outputPanel>
				
					<p:outputPanel style="margin-left:40px; margin-top:20px;">
					<p:outputLabel value="Recurso:"/>
                 	<p:selectOneMenu id="recursos" required="false"  style="margin-left:10px; margin-top:20px;"
													requiredMessage="Recursos	"
													value="#{LaudoController.laudo.recurso}">
												    <f:selectItem itemLabel="TODOS" itemValue="T" />
													<f:selectItem itemLabel="Faec" itemValue="F" />
													<f:selectItem itemLabel="Mac" itemValue="M" />
													<!--  <p:ajax update="pgSetor2"></p:ajax>-->
												
												></p:selectOneMenu>
                  </p:outputPanel>
				
	
					
					 
                         			
				</h:panelGrid>
				
				
				<h:panelGrid columns="3" styleClass="semBorda">
				
						<p:outputPanel style="margin-top:20px;" >
					
					<p:outputLabel value="Situação:"/>
         
                 	<p:selectOneRadio id="situacao" style="border: double;"  required="false" layout="pageDirection" 
													requiredMessage="Situação"
													value="#{LaudoController.laudo.situacao}">
												
													<f:selectItem itemLabel="Pendente" itemValue="P" />
													<f:selectItem itemLabel="Autorizado" itemValue="A" />
													<!--  <p:ajax update="pgSetor2"></p:ajax>-->
												
												</p:selectOneRadio>
                  </p:outputPanel>
                  
                  		<p:outputPanel style="margin-left:16px;">
						<h:outputLabel for="dataAtou" value="Data para Autorização" />
						<br />
						<p:calendar id="dataAt" showOn="button" locale="pt" value="#{LaudoController.laudo.dtautorizacao}" navigator="true" mask="true"
							pattern="dd/MM/yyyy" />
					</p:outputPanel>
					
							<p:outputPanel style="margin-left:16px;" >
						<h:outputLabel for="dataVen" value="Data para Vencimento" />
						<br />
						<p:calendar id="dataVenci" showOn="button" locale="pt" navigator="true" mask="true"
							pattern="dd/MM/yyyy" readonly="true" />
					</p:outputPanel>
				</h:panelGrid>
				
			<p:dataTable emptyMessage="Sem Dados" styleClass="table table-hover" id="tabela"
                             style="margin-top:20px;" value="#{LaudoController.listaLaudo}"
                             var="tab" paginator="true" paginatorPosition="bottom" rows="12">

                    <p:column headerText="PT-Novo" style="font-weight:bold;width:5%;">
                        <h:outputText value="#{tab.id_apac}" />
                    </p:column>

                    <p:column headerText="CPF" style="font-weight:bold;">
                        <h:outputText value="#{tab.apac}" />
                    </p:column>
                    
                    <p:column headerText="PACIENTE" style="font-weight:bold;">
                        <h:outputText value="#{tab.dtasolicitacao}" />
                    </p:column>
                    
                      <p:column headerText="CARTÃO SUS" style="font-weight:bold;">
                        <h:outputText value="#{tab.dtautorizacao}" />
                    </p:column>
                    
                     <p:column headerText="CHEGADA" style="font-weight:bold;">
                        <h:outputText value="#{tab.situacao}" />
                    </p:column>
                    
                    <p:column headerText="AUTORIZÃO" style="font-weight:bold;">
                        <h:outputText value="#{tab.recurso}" />
                    </p:column>
                    
                      <p:column headerText="STA" style="font-weight:bold;">
                        <h:outputText value="#{tab.unidade}" />
                    </p:column>
                    
                        <p:column headerText="PROCEDIMENTO" style="font-weight:bold;">
                        <h:outputText value="#{tab.cid10_1}" />
                    </p:column>
                    
                        <p:column headerText="CODEQUIPE" style="font-weight:bold;">
                        <h:outputText value="#{tab.cid10_2}" />
                    </p:column>
                    
                        <p:column headerText="CID" style="font-weight:bold;">
                        <h:outputText value="#{tab.codfornecedor}" />
                    </p:column>
                    
                     <p:column headerText="MEDICO" style="font-weight:bold;">
                        <h:outputText value="#{tab.codmedico}" />
                    </p:column>

                    
                    <p:column headerText="Ações" width="15%">
                            <center>
                                <p:splitButton icon="confirmar">
                                    <p:menuitem value="Alterar" icon="alterar-dados"  
                                       action ="/pages/sishosp/cadastroLaudo.faces" >
                                        <f:setPropertyActionListener value="#{tab}" target="#{LaudoController.laudo}" />
                                        
  
                                       
                                       <f:setPropertyActionListener value="A" target="#{LaudoController.tipo}" /> 
                                    </p:menuitem>
                                    
                                    <p:menuitem value="Excluir" icon="trash" 
                                        onclick="PF('dialogAtencao').show()">

                                        <f:setPropertyActionListener value="#{tab.id_apac}" target="#{LaudoController.laudo.id_apac}" />
                                    </p:menuitem>
                                </p:splitButton>   
                            </center>
                        </p:column>
                </p:dataTable>
				    	
				    	
                                  <p:separator></p:separator>
				<center>
					<h:panelGrid columns="3" styleClass="semBorda">
						
						<p:commandButton value="Gravar" icon="confirmar"  update=":formLaudo:message,:formLaudo"
							action="#{LaudoController.gravarLaudo()}" rendered="#{LaudoController.tipo == 'I'}"/>
							
							 <p:commandButton action="#{LaudoController.alterarLaudo()}" icon="alterar-dados"  
                             update=":formLaudo:message,:formLaudo" value="Alterar"
                             rendered="#{LaudoController.tipo == 'A'}" />
						
						<p:commandButton value="Consultar" icon="buscar" />
						
						<p:commandButton value="Limpar" icon="limpar"
							actionListener="#{LaudoController.limparDados()}"
							update=":formLaudo" />
						
					</h:panelGrid>
				</center>
			</p:panel>
		</h:form>


		

		<p:dialog header="Consulta Programa" widgetVar="dlgConsuProg"
			modal="true" width="500px">
			<h:form id="formConsuProg">
				<p:dataTable value="#{ProgramaController.listaProgramas}" var="prog"
					resizableColumns="true"
					emptyMessage="Não existe nenhum programa cadastrado!">
					<p:column headerText="CÓD.">
						<p:outputLabel value="#{prog.idPrograma}" />
					</p:column>
					<p:column headerText="PROGRAMA">
						<p:outputLabel value="#{prog.descPrograma}" />
					</p:column>
					<p:column style="width:50px;text-align: center">
						<p:commandButton
						    update=":formLaudo:outProg"
							icon="ui-icon-check" title="Selecionar"
							action="#{GrupoController.atualizaLista(LaudoController.laudo.programa)}"
							onclick="PF('dlgConsuProg').hide();">
							<f:setPropertyActionListener value="#{prog}"
								target="#{LaudoController.laudo.programa}" />
						</p:commandButton>
					</p:column>
				</p:dataTable>
			</h:form>
		</p:dialog>

		
    </div>

        </ui:define>
    </ui:composition>
</html>