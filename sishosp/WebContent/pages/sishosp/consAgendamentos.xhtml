<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:b="http://bootsfaces.net/ui"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="../../template/template.xhtml">

    <ui:define name="content">

        <h:form>
            <b:row rendered="#{MBFuncionarios.listarUnidadesDoFuncionario().size()>1}">

                <b:column span="1">
                    <h:outputLabel value="Unidade:" style="margin-top:5px;"/>
                </b:column>

                <b:column span="2">
                    <p:selectOneMenu value="#{AgendaController.agenda.empresa.codEmpresa}">
                        <f:selectItems value="#{MBFuncionarios.listarUnidadesDoFuncionario()}"
                                       var="emp" itemLabel="#{emp.nomeFantasia}"
                                       itemValue="#{emp.codEmpresa}"/>
                        <p:ajax event="change" process="@this"/>
                    </p:selectOneMenu>

                </b:column>

                <br></br>

            </b:row>
        </h:form>

        <div class="panel panel-primary top-primary">
            <div class="panel-heading top-heading">
                <h4 class="panel-title">Consultar Agendamentos</h4>
            </div>

            <div class="panel-body table-body">

                <h:form id="formConsAge">

					<b:row>
						<p:outputPanel class="data-size5">
							<b:column span="2" class="label-position data-size">
								<b:label value="Data da Marcação:" severity="info" />

								<p:calendar pattern="dd/MM/yyyy" mask="true" navigator="true"
									showOn="button" size="15" class="select-agendaEquipe2"
									value="#{AgendaController.dataAtendimentoC}" />
							</b:column>


                            <b:column span="1" class="data-size4">
                                <p:outputLabel id="outdataa">
                                    <h:outputLabel value="a"/>
                                </p:outputLabel>
                            </b:column>

                            <b:column span="2" class="label-position data-size3">
                                <p:calendar value="#{AgendaController.dataAtendimentoFinalC}" style="margin-left: 20px"
                                            id="dtagen3" locale="pt" navigator="true" mask="true"
                                            showOn="button" pattern="dd/MM/yyyy">
                                </p:calendar>
                            </b:column>

                            <b:commandButton value="Buscar" icon="glyphicon-search" style="margin-left:10px"
                                             action="#{AgendaController.consultarAgenda()}"
                                             update=":formConsAge:dtConsultas, :formConsAge:msgPagina"></b:commandButton>
                        </p:outputPanel>

					</b:row>
					<br />
					<b:dataTable customLangUrl="#{resource['pt-br.json']}"
						resizableColumns="true" id="dtConsultas"
						emptyMessage="Sem registros." scrollable="true" paginator="true"
						rows="15" var="agenda" value="#{AgendaController.listaConsulta}">

                        <h:column>
                            <f:facet name="header">
                                Data
                            </f:facet>
                            <h:outputLabel value="#{agenda.dataAtendimento}">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </h:outputLabel>
                        </h:column>

                        <h:column>
                            <f:facet name="header">
                                Paciente
                            </f:facet>
                            <p:outputLabel value="#{agenda.paciente.nome}"/>
                        </h:column>

                        <h:column>
                            <f:facet name="header">
                                CNS
                            </f:facet>
                            <p:outputLabel value="#{agenda.paciente.cns}"/>
                        </h:column>

                        <h:column>
                            <f:facet name="header">
                                Tipo de Atendimento
                            </f:facet>
                            <p:outputLabel value="#{agenda.tipoAt.descTipoAt}"/>
                        </h:column>

                        <h:column>
                            <f:facet name="header">
                                Turno
                            </f:facet>
                            <h:outputLabel value="MANHÃ" rendered="#{agenda.turno == 'M'}"/>
                            <h:outputLabel value="TARDE" rendered="#{agenda.turno == 'T'}"/>
                        </h:column>

                        <h:column>
                            <f:facet name="header">
                                Profissional
                            </f:facet>
                            <p:outputLabel value="#{agenda.profissional.nome}"/>
                        </h:column>

                        <h:column>
                            <f:facet name="header">
                                Equipe
                            </f:facet>
                            <p:outputLabel value="#{agenda.equipe.descEquipe}"/>
                        </h:column>

                    </b:dataTable>


                    <div align="center">
                        <b:messages value="Error" id="msgPagina"></b:messages>
                    </div>

                    <br></br>

                    <div align="center">

                        <b:commandButton value="Voltar" icon="glyphicon-arrow-left" class="btn-voltar btn-voltar1"
                                         size="sm" immediate="true" look="info" update=":formConsAge"
                                         actionListener="#{AgendaController.limparDados()}"
                                         action="/pages/comum/selecaoSistema2.faces?faces-redirect=true">
                        </b:commandButton>


                    </div>

                </h:form>
            </div>
        </div>

    </ui:define>
</ui:composition>